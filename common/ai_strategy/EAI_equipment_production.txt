##################################################
#	EQUIPMENT SCRIPTS
##################################################

############ old
equipment_production_inf_air_m = {
	enable = {
		NOT = { major_country = yes }
		NOT = { original_tag = CHI }
		has_equipment = { infantry_equipment > 50000 }
	}
	abort = {
		NOT = { has_equipment = { infantry_equipment > 20000 } }
	}

	ai_strategy = { type = equipment_production_factor id = infantry 			                value = -50 }

	ai_strategy = { type = equipment_production_factor id = fighter 			                value = 10 }
	ai_strategy = { type = equipment_production_factor id = cas 				                value = 10 }
}
equipment_production_art_air_m = {
	enable = {
		NOT = { major_country = yes }
		has_equipment = { artillery_equipment > 5000 }
		has_tech = artillery4
	}
	abort = {
		NOT = { has_equipment = { artillery_equipment > 1000 } }
	}

	ai_strategy = { type = equipment_production_factor id = artillery 			                value = -50 }

	ai_strategy = { type = equipment_production_factor id = fighter 			                value = 10 }
	ai_strategy = { type = equipment_production_factor id = cas 				                value = 10 }
}
equipment_production_at_air_m = {
	enable = {
		NOT = { major_country = yes }
		has_equipment = { anti_tank_equipment > 5000 }
		has_tech = antitank5
	}
	abort = {
		NOT = { has_equipment = { anti_tank_equipment > 1000 } }
	}

	ai_strategy = { type = equipment_production_factor id = anti_tank 			                value = -50 }

	ai_strategy = { type = equipment_production_factor id = fighter 			                value = 10 }
	ai_strategy = { type = equipment_production_factor id = cas 				                value = 10 }
}

############
equipment_production_armor = {
	enable = {
		OR = {
			has_country_flag = marm_template
			has_country_flag = harm_template
		}
	}

	ai_strategy = { type = equipment_production_factor id = infantry 			value = -20 }
	ai_strategy = { type = equipment_production_factor id = armor 				value = 40 }
}

equipment_production_light_armor = { #the AI produces way too many light tanks so the mechanized token is used to reduce it
	enable = {
		NOT = { larm_army_focus = yes }
		OR = {
			original_tag = GER
			original_tag = SOV
		}
	}

	ai_strategy = { type = equipment_production_factor id = mechanized 			value = -99 }
}
equipment_production_light_armor_2 = {
	enable = {
		NOT = { larm_army_focus = yes }
		NOT = {
			original_tag = GER
			original_tag = SOV
		}
	}

	ai_strategy = { type = equipment_production_factor id = mechanized 			value = -50 }
}

############
air_strategy_balance = { #reduce air production when there is no need for it
	enable = {
		has_war = yes
		has_deployed_air_force_size = { size > 3000 }
		NOT = {
			any_enemy_country = { has_deployed_air_force_size = { size > 500 } }
			AND = {
				has_government = fascism
				OR = {
					any_neighbor_country = { NOT = { has_government = fascism } has_deployed_air_force_size = { size > 500 } }
					any_allied_country = {
						any_neighbor_country = { NOT = { has_government = fascism } has_deployed_air_force_size = { size > 500 } }
					}
				}
			}
			AND = {
				has_government = communism
				OR = {
					any_neighbor_country = { NOT = { has_government = communism } has_deployed_air_force_size = { size > 500 } }
					any_allied_country = {
						any_neighbor_country = { NOT = { has_government = communism } has_deployed_air_force_size = { size > 500 } }
					}
				}
			}
			AND = {
				has_government = democratic
				OR = {
					any_neighbor_country = { NOT = { has_government = democratic } has_deployed_air_force_size = { size > 500 } }
					any_allied_country = {
						any_neighbor_country = { NOT = { has_government = democratic } has_deployed_air_force_size = { size > 500 } }
					}
				}
			}
		}
	}
	abort = {
		OR = {
			NOT = { has_deployed_air_force_size = { size > 3000 } }
			any_enemy_country = { has_deployed_air_force_size = { size > 500 } }
			AND = {
				has_government = fascism
				OR = {
					any_neighbor_country = { NOT = { has_government = fascism } has_deployed_air_force_size = { size > 500 } }
					any_allied_country = {
						any_neighbor_country = { NOT = { has_government = fascism } has_deployed_air_force_size = { size > 500 } }
					}
				}
			}
			AND = {
				has_government = communism
				OR = {
					any_neighbor_country = { NOT = { has_government = communism } has_deployed_air_force_size = { size > 500 } }
					any_allied_country = {
						any_neighbor_country = { NOT = { has_government = communism } has_deployed_air_force_size = { size > 500 } }
					}
				}
			}
			AND = {
				has_government = democratic
				OR = {
					any_neighbor_country = { NOT = { has_government = democratic } has_deployed_air_force_size = { size > 500 } }
					any_allied_country = {
						any_neighbor_country = { NOT = { has_government = democratic } has_deployed_air_force_size = { size > 500 } }
					}
				}
			}
		}
	}

	ai_strategy = { type = air_factory_balance                                                  value = -50 }
}

############ AI is reluctant to use its airforce: dump the factories into infantry equipment
air_strategy_too_many_fighters = {
	enable = {
		has_equipment = { infantry_equipment < 10000 }

		OR = {
			has_deployed_air_force_size = { size > 8000 type = fighter }
			has_equipment = { fighter_equipment > 8000 }
		}
	}
	abort = {
		OR = {
			NOT = { has_equipment = { infantry_equipment < 20000 } }

			NOT = {
				has_deployed_air_force_size = { size > 6000 type = fighter }
				has_equipment = { fighter_equipment > 6000 }
			}
		}
	}

	ai_strategy = { type = equipment_production_factor id = fighter                        	 	 value = -100 }

	ai_strategy = { type = equipment_production_factor id = infantry                        	 value = 75 }
	ai_strategy = { type = equipment_production_factor id = motorized                    		 value = 75 }
	ai_strategy = { type = equipment_production_factor id = artillery                    		 value = 75 }
}

############ AI assigns too many factories in late game without having the resources
production_reduction_0 = {
	enable = {
		num_of_military_factories > 300
	}
	abort = {
		NOT = { num_of_military_factories > 275 }
	}

	ai_strategy = { type = equipment_production_factor id = armor                             	value = -10 }
	ai_strategy = { type = air_factory_balance                             						value = -10 }
}
production_reduction_1 = {
	enable = {
		num_of_military_factories > 325
	}
	abort = {
		NOT = { num_of_military_factories > 300 }
	}

	ai_strategy = { type = equipment_production_factor id = armor                             	value = -10 }
	ai_strategy = { type = air_factory_balance                             						value = -10 }
}
production_reduction_2 = {
	enable = {
		num_of_military_factories > 350
	}
	abort = {
		NOT = { num_of_military_factories > 325 }
	}

	ai_strategy = { type = equipment_production_factor id = armor                             	value = -10 }
	ai_strategy = { type = air_factory_balance                             						value = -10 }
}
production_reduction_3 = {
	enable = {
		num_of_military_factories > 375
	}
	abort = {
		NOT = { num_of_military_factories > 350 }
	}

	ai_strategy = { type = equipment_production_factor id = armor                             	value = -10 }
	ai_strategy = { type = air_factory_balance                             						value = -10 }
}
production_reduction_4 = {
	enable = {
		num_of_military_factories > 400
	}
	abort = {
		NOT = { num_of_military_factories > 375 }
	}

	ai_strategy = { type = equipment_production_factor id = armor                             	value = -10 }
	ai_strategy = { type = air_factory_balance                             						value = -10 }
}
production_reduction_5 = {
	enable = {
		num_of_military_factories > 425
	}
	abort = {
		NOT = { num_of_military_factories > 400 }
	}

	ai_strategy = { type = equipment_production_factor id = armor                             	value = -10 }
	ai_strategy = { type = air_factory_balance                             						value = -10 }
}
production_reduction_6 = {
	enable = {
		num_of_military_factories > 450
	}
	abort = {
		NOT = { num_of_military_factories > 425 }
	}

	ai_strategy = { type = equipment_production_factor id = armor                             	value = -10 }
	ai_strategy = { type = air_factory_balance                             						value = -10 }
}
production_reduction_7 = {
	enable = {
		num_of_military_factories > 475
	}
	abort = {
		NOT = { num_of_military_factories > 450 }
	}

	ai_strategy = { type = equipment_production_factor id = armor                             	value = -10 }
	ai_strategy = { type = air_factory_balance                             						value = -10 }
}
production_reduction_8 = {
	enable = {
		num_of_military_factories > 500
	}
	abort = {
		NOT = { num_of_military_factories > 475 }
	}

	ai_strategy = { type = equipment_production_factor id = armor                             	value = -10 }
	ai_strategy = { type = air_factory_balance                             						value = -10 }
}

######################################
#	convoy production
######################################

convoy_strategy_0 = { #majors
	enable = {
		major_country = yes NOT = { original_tag = SOV original_tag = USA }
		has_equipment = { convoy > 300 }
		
		OR = { has_tech = basic_destroyer has_tech = basic_light_cruiser }
	}
	abort = {
		NOT = { has_equipment = { convoy > 200 } }
	}

	ai_strategy = { type = equipment_production_factor id = convoy 			                    value = -200 }
}
convoy_strategy_0b = { #minors
	enable = {
		NOT = { major_country = yes }
		has_equipment = { convoy > 100 }
		
		OR = { has_tech = basic_destroyer has_tech = basic_light_cruiser }
	}
	abort = {
		NOT = { has_equipment = { convoy > 50 } }
	}

	ai_strategy = { type = equipment_production_factor id = convoy 			                    value = -200 }
}
convoy_strategy_0c = { #USA transfers absurd numbers of troops
	enable = {
		original_tag = USA
		has_equipment = { convoy > 500 }
		
		OR = { has_tech = basic_destroyer has_tech = basic_light_cruiser }
	}
	abort = {
		NOT = { has_equipment = { convoy > 400 } }
	}

	ai_strategy = { type = equipment_production_factor id = convoy 			                    value = -200 }
}
convoy_strategy_0d = { #USSR needs convoys for lend leasing
	enable = {
		original_tag = SOV
		has_equipment = { convoy > 600 }
		
		OR = { has_tech = basic_destroyer has_tech = basic_light_cruiser }
	}
	abort = {
		NOT = { has_equipment = { convoy > 500 } }
	}

	ai_strategy = { type = equipment_production_factor id = convoy 			                    value = -200 }
}

convoy_strategy_1 = { #majors
	enable = {
		major_country = yes
		has_equipment = { convoy < 50 }

		NOT = { has_global_flag = EAI_free_convoys }
	}
	abort = {
		NOT = { has_equipment = { convoy < 100 } }
	}
	
	ai_strategy = { type = equipment_production_factor id = capital_ship 			            value = -20 }
	ai_strategy = { type = equipment_production_factor id = carrier 			                value = -100 }
	ai_strategy = { type = equipment_production_factor id = screen_ship 			            value = -50 }
	ai_strategy = { type = equipment_production_factor id = convoy 			                    value = 600 }
}
convoy_strategy_1b = { #minors
	enable = {
		NOT = { major_country = yes }
		has_equipment = { convoy < 50 }
	}
	abort = {
		NOT = { has_equipment = { convoy < 100 } }
	}

	ai_strategy = { type = equipment_production_factor id = capital_ship 			            value = -20 }
	ai_strategy = { type = equipment_production_factor id = carrier 			                value = -100 }
	ai_strategy = { type = equipment_production_factor id = screen_ship 			            value = -50 }
	ai_strategy = { type = equipment_production_factor id = convoy 			                    value = 600 }
}

convoy_strategy_2 = {
	enable = {
		has_global_flag = EAI_free_convoys
	}
	abort = {
		NOT = { has_global_flag = EAI_free_convoys }
	}

	ai_strategy = { type = equipment_production_factor id = convoy 			                    value = -50 }
}

######################################
#	navy production ratios
######################################

#under 3:1 screen ratio, increase screen production
navy_strategy_1 = {
	enable = { has_country_flag = prioritise_screen_ships }
	abort = { NOT = { has_country_flag = prioritise_screen_ships } }

	ai_strategy = { type = equipment_production_factor id = carrier 		                    value = -140 }
	ai_strategy = { type = equipment_production_factor id = capital_ship 	                    value = -40 }
	
	ai_strategy = { type = equipment_production_factor id = screen_ship 	                    value = 400 }
}

#above 4:1 screen ratio, increase capital production
navy_strategy_2 = {
	enable = { has_country_flag = prioritise_capital_ships }
	abort = { NOT = { has_country_flag = prioritise_capital_ships } }

	ai_strategy = { type = equipment_production_factor id = screen_ship 	                    value = -90 }
	
	ai_strategy = { type = equipment_production_factor id = capital_ship 	                    value = 400 }
	ai_strategy = { type = equipment_production_factor id = carrier 	                    	value = 400 }
}